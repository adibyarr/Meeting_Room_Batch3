@model IEnumerable<MeetingRoomWebApp.AutoGen.User>
@{
    ViewBag.Title = "User List";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="text-center">
    <h1 class="display-4">User List</h1>

    <div>
        <table class="table table-hover">
            <thead>
                <tr style="background-color: rgba(230, 230, 230, 0.659);">
                    <th scope="col">
                        User ID
                    </th>
                    <th scope="col">
                        Username
                    </th>
                    <th scope="col">
                        Email
                    </th>
                    <th scope="col">
                        Role
                    </th>
                    <th scope="col">
                        Action
                    </th>
                </tr>
            </thead>

            @foreach (var user in Model)
            {
                <tbody>
                    <tr>
                        <td scope="col">
                            @user.UserId
                        </td>
                        <td scope="col">
                            @user.Username
                        </td>
                        <td scope="col">
                            @user.Email
                        </td>
                        <td scope="col">
                            @user.Role
                        </td>
                        <td scope="col">
                            <button class="updateUserBtn btn btn-warning">
                                <i class="fa-solid fa-pen-to-square"></i>
                            </button>
                            @if (@user.Role.Equals("Admin"))
                            {
                                <button class="btn btn-danger" disabled>
                                    <i class="fa-solid fa-trash"></i>
                                </button>
                            }
                            else
                            {
                                <button class="btn btn-danger" onclick="popupDeleteUser('@user.Username', '@user.UserId')">
                                    <i class="fa-solid fa-trash"></i>
                                </button>
                            }
                        </td>
                    </tr>
                </tbody>
            }
        </table>
    </div>

    @* Pop Up Window *@
    <div class="modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ini Title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure want to delete user?</p>
                </div>
                <div class="modal-footer">
                    <form>
                        <button type="button" class="btn btn-danger">Yes</button>
                        <button type="button" class="btn btn-primary">No</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    // Delete Confirmation Popup
    function popupDeleteUser(username, userId) {

        $(".modal-title").html("Delete User");

        $(".modal-body").html(
            `
        <div class="row p-2">
            <p>Are you sure you want to delete user <strong>${username}</strong>?</p>
        </div>
        `
        );

        $(".modal-footer").html(
            `
            <form method="post" action="/Admin/DeleteUser/${userId}">
                <input type="submit" class="btn btn-danger" value="Yes"/>
                <button type="button" id="cancel-delete" class="btn btn-primary">No</button>
            <form>
        `
        );

        $("#cancel-delete").click(function () {
            $(".modal").modal("hide");
        });

        $(".modal").modal("show");
    }
</script>