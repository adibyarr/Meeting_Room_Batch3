@model MeetingRoomWebApp.AutoGen.User

@{
    ViewBag.Title = "Booking";
    if (Model.Roles.RoleName == "Admin")
    {
        Layout = "~/Views/Shared/_AdminLayout.cshtml";
    }
}

<div class="text-center">
    <h1 class="display-4">Booking</h1>
    <div class="container rounded bg-white mt-5"></div>
    <div class="mx-auto" style="max-width: 600px;">
        <form method="post" action="/Booking/AvailableRooms">
            <input type="hidden" name="userId" value="@Model.UserId" />
            <table class="table table-borderless">
                <tr>
                    <td>
                        <p>Date : </p>
                    </td>
                    <td>
                        <div class="container">
                            <div class="row">
                                <div class="col-sm">
                                    <input type="text" class="form-control" name="startDate" required id="datepicker"
                                        placeholder="MM/DD/YYYY" autocomplete="off" />
                                </div>
                                <div class="col-sm">
                                    <input type="text" class="form-control" name="endDate" required id="datepicker2"
                                        placeholder="MM/DD/YYYY" autocomplete="off" />
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>Time : </p>
                    </td>
                    <td>
                        <div class="container">
                            <div class="row">
                                <div class="col-sm">
                                    <input type="text" class="form-control" name="startTime" required
                                        placeholder="HH:MM AM/PM" id="timepicker" autocomplete="off" />
                                </div>
                                <div class="col-sm">
                                    <input type="text" class="form-control" name="endTime" required
                                        placeholder="HH:MM AM/PM" id="timepicker2" autocomplete="off" />
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>Capacity : </p>
                    </td>
                    <td>
                        <div class="container">
                            <div class="row">
                                <div class="col-sm">
                                    <input type="number" class="form-control" name="capacity" required min="1"
                                        id="capacity" placeholder="Required Room Capacity" />
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
            <div class="container">
                <div class="row">
                    <div class="col-sm">
                        <input type="submit" class="btn btn-success" value="Find Room" />
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
</div>

<script>
    $("#datepicker").datepicker({
        minDate: 0,
        showOtherMonths: true,
        selectOtherMonths: true
    });

    var startDate = $("#datepicker").datepicker('getDate');

    $("#datepicker2").datepicker({
        minDate: 0,
        showOtherMonths: true,
        selectOtherMonths: true
    });

    $('#timepicker').timepicker({
        timeFormat: 'hh:mm p',
        dynamic: false,
        dropdown: true,
        scrollbar: true,
    });

    $('#timepicker2').timepicker({
        timeFormat: 'hh:mm p',
        dynamic: false,
        dropdown: true,
        scrollbar: true,
    });

    var now = new Date();
    var dateNow = now.getDate();
    var monthNow = now.getMonth();
    var yearNow = now.getFullYear();

    var datepick = new Date();
    var datepickDateNow = datepick.getDate();
    var datepickMonthNow = datepick.getMonth();
    var datepickYearNow = datepick.getFullYear();

    var datepick2 = new Date();
    var datepick2DateNow = datepick2.getDate();
    var datepick2MonthNow = datepick2.getMonth();
    var datepick2YearNow = datepick2.getFullYear();

    var startDate = new Date();
    $("#datepicker").on("change", function () {
        startDate = $("#datepicker").datepicker('getDate');
        $('#datepicker2').datepicker('option', 'minDate', startDate);
        datepick = $(this).datepicker('getDate');
        datepickDateNow = datepick.getDate();
        datepickMonthNow = datepick.getMonth();
        datepickYearNow = datepick.getFullYear();
        if (datepickDateNow == dateNow && datepickMonthNow == monthNow && datepickYearNow == yearNow) {
            $('#timepicker').timepicker('option', 'minTime', now);
        } else {
            $('#timepicker').timepicker('option', 'minTime', '0');
        }
    });

    $("#datepicker2").on("change", function () {
        datepick2 = $(this).datepicker('getDate');
        datepick2DateNow = datepick2.getDate();
        datepick2MonthNow = datepick2.getMonth();
        datepick2YearNow = datepick2.getFullYear();
    });

    var initTime;
    $("body").on("click", function () {
        initTime = $("#timepicker").val() || "something";
        if (initTime != "something")
            $('#timepicker2').timepicker('option', 'minTime', initTime);
        console.log(initTime);
    });
</script>